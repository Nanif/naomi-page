(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b801c1aa"],{"2fdb":function(t,e,a){"use strict";var s=a("5ca1"),n=a("d2c8"),i="includes";s(s.P+s.F*a("5147")(i),"String",{includes:function(t){return!!~n(this,t,i).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},"508f":function(t,e,a){},5147:function(t,e,a){var s=a("2b4c")("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(a){try{return e[s]=!1,!"/./"[t](e)}catch(n){}}return!0}},6762:function(t,e,a){"use strict";var s=a("5ca1"),n=a("c366")(!0);s(s.P,"Array",{includes:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")("includes")},"861b":function(t,e,a){"use strict";a("508f")},c7c8:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("page-title",{attrs:{heading:t.heading,subheading:t.subheading,icon:t.icon}}),a("div",{staticClass:"content"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"main-card mb-3 card"},[a("loader",{attrs:{loading:t.loading}}),t.loading?t._e():a("div",[a("div",{staticClass:"card-header-tab card-header"},[t._m(0),a("b-form-checkbox",{attrs:{name:"ordersCheck",switch:""},on:{change:function(e){t.currentPage=1}},model:{value:t.ordersCheck,callback:function(e){t.ordersCheck=e},expression:"ordersCheck"}},[t._v(" הצגת הזמנות פעילות בלבד ")])],1),a("div",{staticClass:"no-gutters row"},[a("div",{staticClass:"col-sm-6 col-md-4 col-xl-4"},[a("div",{staticClass:"card no-shadow rm-border bg-transparent widget-chart text-left"},[t._m(1),a("div",{staticClass:"widget-chart-content"},[a("div",{staticClass:"widget-numbers"},[t._v(t._s(t.filteredOrders.length))]),a("div",{staticClass:"widget-subheading",staticStyle:{"text-align":"right"}},[t._v(" כמות הזמנות ")])])]),a("div",{staticClass:"divider m-0 d-md-none d-sm-block"})]),a("div",{staticClass:"col-sm-6 col-md-4 col-xl-4"},[a("div",{staticClass:"card no-shadow rm-border bg-transparent widget-chart text-left"},[t._m(2),a("div",{staticClass:"widget-chart-content"},[a("div",{staticClass:"widget-numbers"},[t._v(t._s(parseInt(t.totalAmount).toLocaleString())+" ₪ ")]),a("div",{staticClass:"widget-subheading",staticStyle:{"text-align":"right"}},[t._v("סכום כולל ")])])]),a("div",{staticClass:"divider m-0 d-md-none d-sm-block"})]),a("div",{staticClass:"col-sm-6 col-md-4 col-xl-4"},[a("div",{staticClass:"card no-shadow rm-border bg-transparent widget-chart text-left"},[t._m(3),a("div",{staticClass:"widget-chart-content"},[a("div",{staticClass:"widget-numbers"},[t._v(t._s(t.avgAmount)+" ₪")]),a("div",{staticClass:"widget-subheading",staticStyle:{"text-align":"right"}},[t._v("סכום ממוצע להזמנה ")])])]),a("div",{staticClass:"divider m-0 d-md-none d-sm-block"})])]),a("div",{staticClass:"card-body"},[a("div",[a("b-table",{attrs:{striped:!0,hover:!0,items:t.ordersByPage,fields:t.ordersFields},scopedSlots:t._u([{key:"cell(currentStatus)",fn:function(e){return[e.value.status?a("div",{staticClass:"mb-2 ml-2 badge",class:(t.statusMapping[e.value.status||"none"]||{}).badge,staticStyle:{"vertical-align":"-webkit-baseline-middle"}},[t._v(t._s(e.value.name||"לא ידוע")+" ")]):t._e(),a("i",{staticClass:"fas fa-history",staticStyle:{cursor:"pointer"},attrs:{title:"היסטורית סטטוסים"},on:{click:e.toggleDetails}})]}},{key:"row-details",fn:function(e){return[a("div",{staticClass:"vertical-time-simple vertical-without-time vertical-timeline vertical-timeline--animate vertical-timeline--one-column"},t._l(e.item.statuses,(function(e){return a("div",{key:e.id,staticClass:"vertical-timeline-element",class:t.statusMapping[e.status].class},[a("div",[a("span",{staticClass:"vertical-timeline-element-icon bounce-in"}),a("div",{staticClass:"vertical-timeline-element-content bounce-in"},[a("h4",{staticClass:"timeline-title"},[t._v(t._s(e.insertTime)+" "+t._s(e.insertDate)+" - "+t._s(e.title))])])])])})),0)]}},{key:"cell(externalId)",fn:function(e){return[a("a",{attrs:{href:t.integration.website+"/wp-admin/post.php?post="+e.value+"&action=edit",target:"_blank"}},[t._v(t._s(e.value))])]}},{key:"cell(paymentOptionId)",fn:function(e){return[e.item.paymentData&&t.pendingStatuses.includes(e.item.currentStatus.status)?a("div",[a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal:[`modal-${data.item.id}`]",arg:"modal-"+e.item.id}],staticClass:"btn-hover-shine btn-transition",attrs:{variant:"outline-info"}},[t._v("סליקה ידנית ")]),a("b-modal",{attrs:{id:"modal-"+e.item.id,size:"lg",title:"פרטי תשלום","ok-title-html":"<span>סגירה</span>","ok-only":!0},on:{show:function(a){return t.decryptPayment(e.item.id)},hide:t.clearPaymentData}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.currentPaymentData,expression:"currentPaymentData"}]},[t.clearing.clearingOnlineLink?a("p",[a("a",{attrs:{href:t.clearing.clearingOnlineLink,target:"_blank"}},[t._v("קישור לדף סליקה אינטרנטי")])]):t._e(),a("div",{staticClass:"divider"}),a("p",[a("strong",[t._v("מספר כרטיס: ")]),t._v(" "),a("span",{staticClass:"my-4"},[t._v(t._s(t.currentPaymentData.creditNumber))])]),a("p",[a("strong",[t._v("תוקף: ")]),a("span",{staticClass:"my-4"},[t._v(t._s(t.currentPaymentData.creditMonth))]),t._v("/"),a("span",{staticClass:"my-4"},[t._v(t._s(t.currentPaymentData.creditYear))])]),a("p",[a("strong",[t._v("3 ספרות בגב הכרטיס: ")]),a("span",{staticClass:"my-4"},[t._v(t._s(t.currentPaymentData.creditCVV))])]),a("p",[a("strong",[t._v("מספר זהות: ")]),a("span",{staticClass:"my-4"},[t._v(t._s(t.currentPaymentData.identity))])]),a("p",[a("strong",[t._v("סכום לתשלום: ")]),a("span",{staticClass:"my-4"},[t._v(t._s(e.item.total))])])])])],1):t._e()]}}],null,!1,18055665)}),t.filteredOrders.length>10?a("b-pagination",{attrs:{size:"md","total-rows":t.filteredOrders.length,"per-page":10},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e()],1)])])],1)])])])],1)},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card-header-title font-size-lg text-capitalize font-weight-normal"},[a("i",{staticClass:"header-icon lnr-charts icon-gradient bg-happy-green"}),t._v("נתונים ")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"icon-wrapper rounded-circle"},[a("div",{staticClass:"icon-wrapper-bg opacity-10 bg-tempting-azure"}),a("i",{staticClass:"pe-7s-cart text-white opacity-8"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"icon-wrapper rounded-circle"},[a("div",{staticClass:"icon-wrapper-bg opacity-9 bg-tempting-azure"}),a("i",{staticClass:"pe-7s-cash text-white opacity-8"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"icon-wrapper rounded-circle"},[a("div",{staticClass:"icon-wrapper-bg opacity-9 bg-tempting-azure"}),a("i",{staticClass:"pe-7s-calculator text-white opacity-8"})])}],i=(a("8e6e"),a("ac6a"),a("456d"),a("7514"),a("96cf"),a("1da1")),r=(a("6762"),a("2fdb"),a("ade3")),c=a("1a01"),d=a("2f62"),l=a("6e9c"),o=a("025e");function u(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function g(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?u(Object(a),!0).forEach((function(e){Object(r["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var m={components:{PageTitle:c["a"],Loader:l["a"]},data:function(){return{heading:"הזמנות",subheading:"הזמנות שבוצעו דרך הקטלוג החכם.",icon:"pe-7s-cart",ordersFields:[{id:{label:"מזהה"}},{customerFullName:{label:"שם לקוח"}},{total:{label:"סכום כולל"}},{insertDateTime:{label:"תאריך ושעת הזמנה"}},{externalId:{label:"מזהה חיצוני"}},{paymentOptionId:{label:"תשלום"}},{currentStatus:{label:"סטטוס נוכחי"}}],statusesFields:[{status:{label:"סטטוס"}},{insertDate:{label:"תאריך ושעת עדכון"}},{insertBy:{label:"עודכן על ידי"}}],statusMapping:{none:{class:"dot-success",badge:"badge-success"},created:{class:"dot-success",badge:"badge-success"},updated:{class:"dot-warning",badge:"badge-warning"},deleted:{class:"dot-danger",badge:"badge-danger"},restored:{class:"dot-info",badge:"badge-info"},pending:{class:"dot-warning",badge:"badge-warning"},processing:{class:"dot-warning",badge:"badge-warning"},"on-hold":{class:"dot-warning",badge:"badge-warning"},completed:{class:"dot-success",badge:"badge-success"},cancelled:{class:"dot-danger",badge:"badge-danger"},refunded:{class:"dot-warning",badge:"badge-warning"},failed:{class:"dot-danger",badge:"badge-danger"},trash:{class:"dot-danger",badge:"badge-danger"},post_to_woocommerce:{class:"dot-danger",badge:"badge-warning"},saved_manual_smarket_clearing:{class:"dot-danger",badge:"badge-warning"}},activeStatuses:["post_to_woocommerce","saved_manual_smarket_clearing","pending","processing","on-hold","completed"],pendingStatuses:["pending","processing","on-hold","saved_manual_smarket_clearing"],currentPage:1,manualPassword:"",currentPaymentData:"",loading:!1,ordersCheck:!0}},computed:g(g(g(g({},Object(d["c"])("orders",["orders"])),Object(d["c"])("clearing",["clearing"])),Object(d["c"])("settings",["integration"])),{},{filteredOrders:function(){var t=this;return this.ordersCheck?this.orders.filter((function(e){return t.activeStatuses.includes(e.currentStatus?e.currentStatus.status:"")})):this.orders},ordersByPage:function(){return this.filteredOrders?this.filteredOrders.slice(10*(this.currentPage-1),10*this.currentPage):[]},totalAmount:function(){return this.filteredOrders.map((function(t){return parseFloat(t.priceSum)})).reduce((function(t,e){return t+e}),0).toFixed(0)},avgAmount:function(){return this.filteredOrders.length?(this.totalAmount/this.filteredOrders.length).toFixed(0):0}}),mounted:function(){var t=this;this.loading=!0,this.getOrders().then((function(){t.loading=!1})),this.getClearing(),this.integration.website||this.getIntegrationData()},methods:g(g(g(g({},Object(d["b"])("orders",["getOrders"])),Object(d["b"])("settings",["getIntegrationData"])),Object(d["b"])("clearing",["getClearing"])),{},{decryptPayment:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=this.orders.find((function(t){return t.id==e})).paymentData,t.next=3,o["a"].decryptCipher(a,this.clearing.password);case 3:s=t.sent,this.currentPaymentData=JSON.parse(s);case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),clearPaymentData:function(){this.currentPaymentData=""}})},b=m,p=(a("861b"),a("2877")),v=Object(p["a"])(b,s,n,!1,null,null,null);e["default"]=v.exports},d2c8:function(t,e,a){var s=a("aae3"),n=a("be13");t.exports=function(t,e,a){if(s(e))throw TypeError("String#"+a+" doesn't accept regex!");return String(n(t))}}}]);